module.exports=function(e){var n={};function r(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=n,r.d=function(e,n,t){r.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,n){if(1&n&&(e=r(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(r.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)r.d(t,o,function(n){return e[n]}.bind(null,o));return t},r.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(n,"a",n),n},r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},r.p="",r(r.s=1)}([function(e,n){e.exports=require("mongoose")},function(e,n,r){(function(e,n){function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=r(3),s=r(4),c=r(5),u=r(6),l=u.signInRoute,a=u.signUpRoute,f=r(0),d=r(8),p=r(9);r(11),r(12);var v=o();v.use(d({name:"_es_demo",secret:"1234",resave:!1,saveUninitialized:!0,cookie:{maxAge:3e5}})),v.use(s.urlencoded({extended:!1})),v.set("view engine","ejs"),v.set("views",p.join(e,"/views")),v.get("/",function(e,n){e.sessionID&&e.session.user?n.render("homepage",{userName:e.session.user}):n.render("login",{title:"Express"})}),v.get("/home",function(e,n){console.log(e.sessionID),console.log(e.session),e.sessionID&&e.session.user?n.render("homepage",{userName:e.session.user}):n.render("login",{title:"Express"})}),v.use(o.static("public")),v.use(s.json());var y={};v.post("/signin",l),v.post("/signup",a),v.get("/getUsers",function(e,n){var r=Object.keys(y).filter(function(n){return n!==e.session.user});console.log(r),n.send(r)});f.connect("mongodb://anandbabu:password123@ds133127.mlab.com:33127/asoft-db"),f.Promise=n.Promise;var g=c(v.listen(8080,function(){console.log("listens to 8080")})),m={},h=0,b=function(e){var n=[];for(i=65;i<78;i++)n.push(e+String.fromCharCode(i));return n},P=function(e){var n=e.currentPlayer;g.in(e.roomId).emit("currentPlayer",{currentPlayer:n})},j=function(e){for(var n in m){var r=m[n];if(r.roomId===e)return r}return null},w=function(e){for(var n,r=0,t=Object.keys(e.players).length,o=b("H").concat(b("S")).concat(b("C")).concat(b("D"));o.length>0;){var i=(n=o.length,Math.floor(Math.random()*Math.floor(n))),s=o.splice(i,1)[0],c=Object.keys(e.players)[r%t];e.players[c].cards||(e.players[c].cards=[]),e.players[c].cards.push(s),r++}!function(e){for(player in e.currentPlayer=null,e.players){var n=y[player];e.players[player].cards.indexOf("SM")>-1&&(e.currentPlayer=player),g.to("".concat(n)).emit("initialCards",{room:e.roomId,players:Object.keys(e.players),cards:e.players[player].cards.sort()})}}(e),P(e)},x=function(e){console.log("isEligibleForCollect");var n=e.acceptedplayers,r=e.currentRoundCardsCount,t=function(e){var n=e.currentRoundPlayerAndCard;console.log(n);var r=0,t=n[r],o=t&&t.card,i=o&&o.split("")[0];for(r++;n[r];){if(n[r].card.split("")[0]!==i)return!0;r++}return!1}(e);return console.log(r),r===n+1?(console.log("isEligibleForCollect",!0,"-- number"),!0):t?(console.log("isEligibleForCollect",!0,"--card cut"),!0):(console.log("isEligibleForCollect",!1),!1)};g.on("connection",function(e){e.on("hi",function(n){console.log(n.name),y[n.name]=e.id,console.log(e.id),console.log(Object.keys(y))}),e.on("chatInRoom",function(n){console.log(n),e.to(n.room).emit("chatInRoom",n.message)}),e.on("cardDrop",function(n){var r=n.room,o=n.userName,i=n.card;console.log("cardDrop",r,o,i),e.to(r).emit("cardReceive",{userName:o,card:i});var s=j(r);if(s.currentRoundPlayerAndCard.push({player:o,card:i}),s.currentRoundCardsCount++,x(s))!function(e){console.log("findFirstPlayerForNextRound");var n=0,r=e.currentRoundPlayerAndCard,o=r[0],i=o.player,s=o.card,c=o.card.split("")[0];for(console.log(o),n++;r[n];){var u=r[n].card.split("")[0];if(console.log(r[n].card,"-- current loop card ",s," -- nextPotentialStaterCard"),console.log(r[n].card>s),u!==c){var l=function(){console.log("got cut the next round first player is -- ",i);var n=y[i],t=[];return r.forEach(function(e){t.push(e.card)}),g.to("".concat(n)).emit("receiveCutCards",{cutCards:t}),e.currentPlayer=i,{v:void 0}}();if("object"===t(l))return l.v}else r[n].card>s&&(s=r[n].card,i=r[n].player);n++}e.currentPlayer=i,console.log("findFirstPlayerForNextRound",e.currentPlayer)}(s),console.log(s.currentPlayer),g.in(r.roomId).emit("currentPlayer",{currentPlayer:"none"}),setTimeout(function(){g.in(s.roomId).emit("clearBoard",""),P(s),s.currentRoundCardsCount=0,s.currentRoundPlayerAndCard=[]},2e3);else{var c=function(e){console.log("findNextUserToPlay");var n=e.currentPlayer,r=e.playersWons,t=Object.keys(e.players).filter(function(e){return-1===r.indexOf(e)}),o=t.indexOf(n)+1;return t[o]?t[o]:t[0]}(s);s.currentPlayer=c,P(s)}}),e.on("playerWon",function(n){var r=n.room,t=n.userName;e.to(r).emit("playerWon",{playerName:t});var o=j(r);o.playersWons.push(t),function(e){e.playersWons,e.players}(o),o.acceptedplayers--}),e.on("invitePpl",function(n){console.log("server",JSON.stringify(n));var r,t,o,i="room-"+h;h++,e.join(i),m[n.invitee]={roomId:i},m[n.invitee].invitedPpl=n.invitedPpl,m[n.invitee].noOfPplInvited=n.invitedPpl.length,m[n.invitee].players=(r={},t=n.invitee,o={},t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r),m[n.invitee].currentRoundCardsCount=0,m[n.invitee].acceptedplayers=0,m[n.invitee].rejectedPlayers=0,m[n.invitee].currentRoundPlayerAndCard=[],m[n.invitee].playersWons=[],console.log(" i;nviting these ppl "+n.invitedPpl.toString()),n.invitedPpl.forEach(function(e){var r=y[e];g.to("".concat(r)).emit("invitePpl",{invitee:n.invitee,room:i})})}),e.on("accept",function(n){m[n.invitee].acceptedplayers=m[n.invitee].acceptedplayers?m[n.invitee].acceptedplayers+1:1,console.log(n.invite+" accepting ",n.invitee),e.join(m[n.invitee].roomId),m[n.invitee].players[n.invite]={},m[n.invitee].acceptedplayers+m[n.invitee].rejectedPlayers===m[n.invitee].noOfPplInvited&&(console.log("all done accepted"),w(m[n.invitee]))}),e.on("reject",function(e){m[e.invitee].rejectedPlayers=m[e.invitee].rejectedPlayers?m[e.invitee].rejectedPlayers+1:1,console.log(e.invite+" rejects ",e.invitee),m[e.invitee].acceptedplayers+m[e.invitee].rejectedPlayers===m[e.invitee].noOfPplInvited&&(console.log("all done reject"),w(m[e.invitee]))}),e.on("refreshToHome",function(e){var n=e.roomId;g.in(n).emit("refreshToHome",{homeURL:"/home"})})}),console.log("end of file")}).call(this,"/",r(2))},function(e,n){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,n){e.exports=require("express")},function(e,n){e.exports=require("body-parser")},function(e,n){e.exports=require("socket.io")},function(e,n,r){var t=r(7);e.exports={signInRoute:function(e,n,r){var o=e.body,i=o.username,s=o.password;console.log(i,s),t.find({username:i}).then(function(r){r.length>0&&s===r[0].password?(e.session.user=i,n.redirect("/home")):n.send("sign in failed")})},signUpRoute:function(e,n,r){var o=e.body,i=o.username,s=o.password;console.log(i,s),t.find({username:i}).then(function(e){e.length>0?n.send("user is already present"):(t.create({username:i,password:s}).then(function(){return console.log("user saved"),!0}).catch(function(e){console.log(e)}),n.send("sign up route"))})}}},function(e,n,r){var t=r(0),o=new(0,t.Schema)({username:{type:String,required:[!0,"userName is required"]},password:{type:String,required:[!0,"password is required"]}}),i=t.model("user",o);e.exports=i},function(e,n){e.exports=require("express-session")},function(e,n,r){(function(e){function r(e,n){for(var r=0,t=e.length-1;t>=0;t--){var o=e[t];"."===o?e.splice(t,1):".."===o?(e.splice(t,1),r++):r&&(e.splice(t,1),r--)}if(n)for(;r--;r)e.unshift("..");return e}var t=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,o=function(e){return t.exec(e).slice(1)};function i(e,n){if(e.filter)return e.filter(n);for(var r=[],t=0;t<e.length;t++)n(e[t],t,e)&&r.push(e[t]);return r}n.resolve=function(){for(var n="",t=!1,o=arguments.length-1;o>=-1&&!t;o--){var s=o>=0?arguments[o]:e.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(n=s+"/"+n,t="/"===s.charAt(0))}return(t?"/":"")+(n=r(i(n.split("/"),function(e){return!!e}),!t).join("/"))||"."},n.normalize=function(e){var t=n.isAbsolute(e),o="/"===s(e,-1);return(e=r(i(e.split("/"),function(e){return!!e}),!t).join("/"))||t||(e="."),e&&o&&(e+="/"),(t?"/":"")+e},n.isAbsolute=function(e){return"/"===e.charAt(0)},n.join=function(){var e=Array.prototype.slice.call(arguments,0);return n.normalize(i(e,function(e,n){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},n.relative=function(e,r){function t(e){for(var n=0;n<e.length&&""===e[n];n++);for(var r=e.length-1;r>=0&&""===e[r];r--);return n>r?[]:e.slice(n,r-n+1)}e=n.resolve(e).substr(1),r=n.resolve(r).substr(1);for(var o=t(e.split("/")),i=t(r.split("/")),s=Math.min(o.length,i.length),c=s,u=0;u<s;u++)if(o[u]!==i[u]){c=u;break}var l=[];for(u=c;u<o.length;u++)l.push("..");return(l=l.concat(i.slice(c))).join("/")},n.sep="/",n.delimiter=":",n.dirname=function(e){var n=o(e),r=n[0],t=n[1];return r||t?(t&&(t=t.substr(0,t.length-1)),r+t):"."},n.basename=function(e,n){var r=o(e)[2];return n&&r.substr(-1*n.length)===n&&(r=r.substr(0,r.length-n.length)),r},n.extname=function(e){return o(e)[3]};var s="b"==="ab".substr(-1)?function(e,n,r){return e.substr(n,r)}:function(e,n,r){return n<0&&(n=e.length+n),e.substr(n,r)}}).call(this,r(10))},function(e,n){var r,t,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function c(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(n){try{return r.call(null,e,0)}catch(n){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(e){r=i}try{t="function"==typeof clearTimeout?clearTimeout:s}catch(e){t=s}}();var u,l=[],a=!1,f=-1;function d(){a&&u&&(a=!1,u.length?l=u.concat(l):f=-1,l.length&&p())}function p(){if(!a){var e=c(d);a=!0;for(var n=l.length;n;){for(u=l,l=[];++f<n;)u&&u[f].run();f=-1,n=l.length}u=null,a=!1,function(e){if(t===clearTimeout)return clearTimeout(e);if((t===s||!t)&&clearTimeout)return t=clearTimeout,clearTimeout(e);try{t(e)}catch(n){try{return t.call(null,e)}catch(n){return t.call(this,e)}}}(e)}}function v(e,n){this.fun=e,this.array=n}function y(){}o.nextTick=function(e){var n=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)n[r-1]=arguments[r];l.push(new v(e,n)),1!==l.length||a||c(p)},v.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=y,o.addListener=y,o.once=y,o.off=y,o.removeListener=y,o.removeAllListeners=y,o.emit=y,o.prependListener=y,o.prependOnceListener=y,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,n,r){e.exports=r.p+"views/homepage.ejs"},function(e,n,r){e.exports=r.p+"views/login.ejs"}]);